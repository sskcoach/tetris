# 테트리스 개발 기록

이 파일은 터미널 기반 테트리스 게임의 전체 개발 과정을 사용자의 요청과 그에 따른 작업 결과 형식으로 기록한 문서입니다.

---

### 1. 프로젝트 시작
- **요청:** "테트리스를 만들건데, 고전 오리지널 스타일로 만들거야. ... 사용할 프로그래밍 언어는 파이썬이야."
- **결과:** Python과 `curses` 라이브러리를 사용한 터미널 기반 테트리스 개발 계획을 제안하고 동의를 얻었습니다.

### 2. 기본 블록 그리기
- **요청:** "하나씩 차근 차근 만들고 확인하면서 진행할거야. 우선 가장 기본적인 테트리미노를 그려줘."
- **결과:** `tetris.py` 파일을 생성하고, 'I' 모양 테트로미노 하나를 화면에 그리는 코드를 작성했습니다.

### 3. 오류 수정 및 기능 확장
- **요청:** "실행했더니 오류났어. `_curses.error: curs_set() returned ERR`"
- **결과:** 터미널 환경에 따라 발생할 수 있는 오류로, `curses.curs_set(0)` 코드를 제거하여 프로그램을 수정했습니다.

- **요청:** "모든 종류의 테트리미노를 하나씩 보여줘."
- **결과:** 7가지 모든 테트로미노 모양을 정의하고, 키를 누를 때마다 다음 모양을 보여주도록 프로그램을 수정했습니다.

- **요청:** "# 으로 하지 말고, [] 으로 변경해줘."
- **결과:** 블록을 그리는 문자를 `#`에서 `[]`로 변경하고, 너비에 맞게 출력 위치를 조정했습니다.

### 4. 게임 보드 구현
- **요청:** "이제 보드를 그려보자. ... 사이즈는 가로 10개, 세로 20개야."
- **결과:** 지정된 크기와 테두리 문자(`<!`, `!>`, `==`, `\/`)를 사용하여 10x20 크기의 게임 보드를 그리는 `draw_board` 함수를 구현했습니다. `\/` 문자로 인한 `SyntaxWarning`도 수정했습니다.

### 5. 핵심 게임 메카닉 구현
- **요청:** "이제 테트리미노가 천천히 떨어지게 해줘."
- **결과:** 게임 루프와 시간 기반 타이머를 구현하여 블록이 자동으로 하강하도록 만들었습니다.

- **요청:** "테트리미노 우측에 커서 같은게 보여" -> "그래도 나와"
- **결과:** `curses.curs_set(0)`을 `try-except` 구문으로 다시 추가하여 커서 숨김을 시도했으나, 문제가 지속되어 커서를 화면 구석으로 이동시키는 방식으로 커서가 보이지 않게 처리했습니다.

- **요청:** "키 입력에 따라 테트리미노가 이동하게 해줘."
- **결과:** 좌, 우, 하 화살표 키로 블록을 조작하는 기능을 추가했습니다. 이후 "키를 누르고 있는 동안은 블럭이 아래로 내려가지 않아" 문제를 해결하기 위해, 게임 시간과 사용자 입력을 분리하여 키를 누르고 있어도 블록이 떨어지도록 로직을 수정했습니다.

- **요청:** "블럭이 바닥에 닿으면, 쌓이게 해줘"
- **결과:** 게임 판의 상태를 기록하는 2차원 배열 `board`를 도입했습니다. 다른 블록 및 바닥과의 충돌 감지 로직을 추가하고, 블록이 닿으면 `board`에 기록되도록(잠기도록) 구현했습니다.

- **요청:** "블럭 회전 처리도 해줘."
- **결과:** `KEY_UP` 키로 블록을 시계 방향으로 90도 회전시키는 기능을 추가했습니다. 이를 위해 블록 모양 정의를 정사각형 배열로 수정하고, 회전 및 충돌 로직을 구현했습니다.

- **요청:** "줄을 채웠을 때, 사라지게 해줘"
- **결과:** 한 줄이 꽉 차면 해당 줄이 사라지고, 위의 줄들이 내려오는 `clear_lines` 함수를 구현했습니다. 줄 제거에 따른 점수 획득 기능도 추가했습니다.

### 6. 전체 구조 리팩토링 및 UI 개선
- **요청:** "화면 씬을 관리하는 로직을 넣어줘. 타이틀, 메인메뉴, 스테이지 관리, 게임오버, 리더보드"
- **결과:** 대규모 리팩토링을 통해 장면(Scene) 관리 시스템을 도입했습니다. 게임을 `TITLE`, `MENU`, `GAME`, `GAME_OVER`, `LEADERBOARD` 상태로 분리하고, `main` 함수가 각 장면을 전환하는 관리자 역할을 하도록 구조를 변경했습니다.

- **요청:** "TITLE 에 오타가 있어. 고쳐줘" -> "TETRIS 라고 나와야 하는데, TETTIE 라고 나와." -> "더 이상해졌어. 그냥 텍스트로 TETRIS 라고 표시해줘."
- **결과:** 타이틀 화면의 ASCII 아트 오타를 수정하고, 이후 사용자의 요청에 따라 간단한 "TETRIS" 텍스트로 최종 변경했습니다.

- **요청:** "커서를 게임화면에서처럼 다른 화면도 모두 우측 하든에 고정해줘."
- **결과:** 게임 장면 외에 타이틀, 메뉴, 게임오버 등 모든 장면에서도 커서가 보이지 않도록 우측 하단으로 이동시키는 코드를 추가했습니다.

- **요청:** "리더보드를 왜 구현하지 않은거야?" -> "그래 한번 해봐"
- **결과:** `leaderboard.txt` 파일에 점수를 저장하고, 게임 오버 시 점수를 기록하며, 리더보드 화면에서 상위 10개의 점수를 불러와 보여주는 영속성 있는 리더보드 기능을 구현했습니다.

- **요청:** "스테이지 개념이 없어. 보강해줘."
- **결과:** 10줄을 제거할 때마다 `level`이 오르고, 레벨에 따라 블록 하강 속도가 빨라지는 스테이지 시스템을 구현했습니다.

- **요청:** "다음 레벨로 넘어가기 위해 필요한 라인수도 같이 표시 해줘."
- **결과:** 게임 정보 UI에 다음 레벨까지 남은 줄의 개수를 표시하도록 수정했습니다.

### 7. 테스트용 치트 기능 추가
- **요청:** "게임을 테스트하기 편하게 치트기능을 넣어줘. 1~4 : 숫자만큼 라인 클리어."
- **결과:** 숫자 키 '1'~'4'를 누르면 즉시 해당 줄 수만큼 보드의 아래쪽 줄을 제거하는 치트 기능을 추가했습니다.

- **요청:** "줄이 사라질때, 점수가 반영 안되네." -> "실제 게임의 동작과 동일하게 동작하도록 같은 함수로 연결해줘."
- **결과:** 치트 사용 시에도 점수와 레벨이 오르도록 수정했습니다. 이후 코드 중복을 제거하고 동작 일관성을 위해, 일반적인 줄 제거와 치트로 인한 줄 제거가 동일한 점수/레벨 처리 함수를 사용하도록 리팩토링했습니다.

- **요청:** (블록 변경 치트 제안 후) "해"
- **결과:** 'c' 키를 누르면 현재 떨어지는 블록을 다른 종류의 블록으로 변경하는 치트 기능을 추가했습니다.